import * as DBAPI from '../../../db';
import * as H from '../../../utils/helpers';
import * as UTIL from '../api';
import * as LOG from '../../../utils/logger';
import * as MIG from '../../../utils/migration';

export class ModelTestCase {
    testCase: string;
    model: DBAPI.Model;
    modelName: string;
    inspectJSON: string;
    assetVersions: DBAPI.AssetVersion[];
    private systemObjectIDs: number[] | null = null;

    constructor(testCase: string, model: DBAPI.Model, modelName: string, assetVersions: DBAPI.AssetVersion[], inspectJSON: string) {
        this.testCase = testCase;
        this.model = model;
        this.modelName = modelName;
        this.assetVersions = assetVersions;
        this.inspectJSON = inspectJSON;
    }

    assetVersionIDs(): number[] {
        const retValue: number[] = [];
        for (const assetVersion of this.assetVersions)
            retValue.push(assetVersion.idAssetVersion);
        return retValue;
    }

    assetFileNameMap(): Map<string, number> {
        const retValue: Map<string, number> = new Map<string, number>();
        for (const assetVersion of this.assetVersions) {
            LOG.info(`ModelTestCase.assetFileNameMap [${assetVersion.FileName}, ${assetVersion.idAssetVersion}]`, LOG.LS.eTEST);
            retValue.set(assetVersion.FileName, assetVersion.idAsset);
        }
        return retValue;
    }

    async computeSystemObjectIDs(): Promise<number[]> {
        if (!this.systemObjectIDs) {
            this.systemObjectIDs = [];
            for (const assetVersion of this.assetVersions) {
                const idAssetVersion = assetVersion.idAssetVersion;
                const SO: DBAPI.SystemObject | null = await DBAPI.SystemObjectAssetVersion.fetchFromAssetVersionID(idAssetVersion);
                if (SO)
                    this.systemObjectIDs.push(SO.idSystemObject);
            }
        }
        return this.systemObjectIDs;
    }
}

// Note, when extracted from logging the expected JSON below needs to have escaping added
// to the color elements below ... replace color: \"0, 0, 0\" with color: \\"0, 0, 0\\"
const modelTestCaseInspectJSONMap: Map<string, string> = new Map<string, string>([
    ['fbx-stand-alone',     '{"success":true,"error":"","modelConstellation":{"Model":{"Name":"eremotherium_laurillardi-150k-4096.fbx","Title":"","DateCreated":"2021-04-01T00:00:00.000Z","idVCreationMethod":0,"idVModality":0,"idVUnits":0,"idVPurpose":0,"idVFileType":59,"idAssetThumbnail":null,"CountAnimations":0,"CountCameras":0,"CountFaces":149999,"CountLights":0,"CountMaterials":1,"CountMeshes":1,"CountVertices":104561,"CountEmbeddedTextures":1,"CountLinkedTextures":1,"FileEncoding":"BINARY","IsDracoCompressed":false,"AutomationTag":null,"CountTriangles":149999,"idModel":1},"ModelObjects":[{"idModelObject":1,"idModel":1,"BoundingBoxP1X":-892.2620849609375,"BoundingBoxP1Y":-2167.86767578125,"BoundingBoxP1Z":-971.3925170898438,"BoundingBoxP2X":892.2653198242188,"BoundingBoxP2Y":2167.867919921875,"BoundingBoxP2Z":971.3912963867188,"CountVertices":104561,"CountFaces":149999,"CountColorChannels":0,"CountTextureCoordinateChannels":1,"HasBones":false,"HasFaceNormals":true,"HasTangents":null,"HasTextureCoordinates":true,"HasVertexNormals":null,"HasVertexColor":false,"IsTwoManifoldUnbounded":false,"IsTwoManifoldBounded":true,"IsWatertight":false,"SelfIntersecting":true,"CountTriangles":149999}],"ModelMaterials":[{"idModelMaterial":1,"Name":"material_0"}],"ModelMaterialChannels":[{"idModelMaterialChannel":1,"idModelMaterial":1,"idVMaterialType":64,"MaterialTypeOther":null,"idModelMaterialUVMap":1,"UVMapEmbedded":false,"ChannelPosition":0,"ChannelWidth":3,"Scalar1":1,"Scalar2":1,"Scalar3":1,"Scalar4":null,"AdditionalAttributes":null,"Source":"../../Users/blundellj/Downloads/eremotherium_laurillardi-150k-4096-obj/eremotherium_laurillardi-150k-4096-diffuse.jpg"}],"ModelMaterialUVMaps":[{"idModel":1,"idAsset":2,"UVMapEdgeLength":0,"idModelMaterialUVMap":1}],"ModelObjectModelMaterialXref":[{"idModelObjectModelMaterialXref":1,"idModelObject":1,"idModelMaterial":1}],"ModelAssets":[{"Asset":{"FileName":"eremotherium_laurillardi-150k-4096.fbx","idAssetGroup":null,"idVAssetType":0,"idSystemObject":null,"StorageKey":null,"idAsset":1},"AssetVersion":{"idAsset":1,"Version":0,"FileName":"eremotherium_laurillardi-150k-4096.fbx","idUserCreator":0,"DateCreated":"2021-04-01T00:00:00.000Z","StorageHash":"","StorageSize":"0","StorageKeyStaging":"","Ingested":null,"BulkIngest":false,"idSOAttachment":null,"FilePath":"","Comment":"Created by Cook si-packrat-inspect","idAssetVersion":1,"IngestedOrig":null},"AssetName":"eremotherium_laurillardi-150k-4096.fbx","AssetType":"Model"},{"Asset":{"FileName":"../../Users/blundellj/Downloads/eremotherium_laurillardi-150k-4096-obj/eremotherium_laurillardi-150k-4096-diffuse.jpg","idAssetGroup":null,"idVAssetType":0,"idSystemObject":null,"StorageKey":null,"idAsset":2},"AssetVersion":{"idAsset":2,"Version":0,"FileName":"../../Users/blundellj/Downloads/eremotherium_laurillardi-150k-4096-obj/eremotherium_laurillardi-150k-4096-diffuse.jpg","idUserCreator":0,"DateCreated":"2021-04-01T00:00:00.000Z","StorageHash":"","StorageSize":"0","StorageKeyStaging":"","Ingested":null,"BulkIngest":false,"idSOAttachment":null,"FilePath":"","Comment":"Created by Cook si-packrat-inspect","idAssetVersion":2,"IngestedOrig":null},"AssetName":"../../Users/blundellj/Downloads/eremotherium_laurillardi-150k-4096-obj/eremotherium_laurillardi-150k-4096-diffuse.jpg","AssetType":"Texture Map diffuse"}]}}'],
    ['fbx-with-support',    '{"success":true,"error":"","modelConstellation":{"Model":{"Name":"eremotherium_laurillardi-150k-4096.fbx","Title":"","DateCreated":"2021-04-01T00:00:00.000Z","idVCreationMethod":0,"idVModality":0,"idVUnits":0,"idVPurpose":0,"idVFileType":59,"idAssetThumbnail":null,"CountAnimations":0,"CountCameras":0,"CountFaces":149999,"CountLights":0,"CountMaterials":1,"CountMeshes":1,"CountVertices":74796,"CountEmbeddedTextures":0,"CountLinkedTextures":1,"FileEncoding":"BINARY","IsDracoCompressed":false,"AutomationTag":null,"CountTriangles":149999,"idModel":1},"ModelObjects":[{"idModelObject":1,"idModel":1,"BoundingBoxP1X":-892.2620849609375,"BoundingBoxP1Y":-2167.86767578125,"BoundingBoxP1Z":-971.3925170898438,"BoundingBoxP2X":892.2653198242188,"BoundingBoxP2Y":2167.867919921875,"BoundingBoxP2Z":971.3912963867188,"CountVertices":74796,"CountFaces":149999,"CountColorChannels":0,"CountTextureCoordinateChannels":1,"HasBones":false,"HasFaceNormals":true,"HasTangents":null,"HasTextureCoordinates":true,"HasVertexNormals":null,"HasVertexColor":false,"IsTwoManifoldUnbounded":false,"IsTwoManifoldBounded":false,"IsWatertight":false,"SelfIntersecting":true,"CountTriangles":149999}],"ModelMaterials":[{"idModelMaterial":1,"Name":"material_0"}],"ModelMaterialChannels":[{"idModelMaterialChannel":1,"idModelMaterial":1,"idVMaterialType":64,"MaterialTypeOther":null,"idModelMaterialUVMap":1,"UVMapEmbedded":false,"ChannelPosition":0,"ChannelWidth":3,"Scalar1":0.8,"Scalar2":0.8,"Scalar3":0.8,"Scalar4":null,"AdditionalAttributes":null,"Source":"/Users/blundellj/OneDrive - Smithsonian Institution/Packrat demo files/model validation demo files/eremotherium_laurillardi-150k-4096-obj/eremotherium_laurillardi-150k-4096-diffuse.jpg"}],"ModelMaterialUVMaps":[{"idModel":1,"idAsset":2,"UVMapEdgeLength":0,"idModelMaterialUVMap":1}],"ModelObjectModelMaterialXref":[{"idModelObjectModelMaterialXref":1,"idModelObject":1,"idModelMaterial":1}],"ModelAssets":[{"Asset":{"FileName":"eremotherium_laurillardi-150k-4096.fbx","idAssetGroup":null,"idVAssetType":0,"idSystemObject":null,"StorageKey":null,"idAsset":1},"AssetVersion":{"idAsset":1,"Version":0,"FileName":"eremotherium_laurillardi-150k-4096.fbx","idUserCreator":0,"DateCreated":"2021-04-01T00:00:00.000Z","StorageHash":"","StorageSize":"0","StorageKeyStaging":"","Ingested":null,"BulkIngest":false,"idSOAttachment":null,"FilePath":"","Comment":"Created by Cook si-packrat-inspect","idAssetVersion":1,"IngestedOrig":null},"AssetName":"eremotherium_laurillardi-150k-4096.fbx","AssetType":"Model"},{"Asset":{"FileName":"/Users/blundellj/OneDrive - Smithsonian Institution/Packrat demo files/model validation demo files/eremotherium_laurillardi-150k-4096-obj/eremotherium_laurillardi-150k-4096-diffuse.jpg","idAssetGroup":null,"idVAssetType":0,"idSystemObject":null,"StorageKey":null,"idAsset":2},"AssetVersion":{"idAsset":2,"Version":0,"FileName":"/Users/blundellj/OneDrive - Smithsonian Institution/Packrat demo files/model validation demo files/eremotherium_laurillardi-150k-4096-obj/eremotherium_laurillardi-150k-4096-diffuse.jpg","idUserCreator":0,"DateCreated":"2021-04-01T00:00:00.000Z","StorageHash":"","StorageSize":"0","StorageKeyStaging":"","Ingested":null,"BulkIngest":false,"idSOAttachment":null,"FilePath":"","Comment":"Created by Cook si-packrat-inspect","idAssetVersion":2,"IngestedOrig":null},"AssetName":"/Users/blundellj/OneDrive - Smithsonian Institution/Packrat demo files/model validation demo files/eremotherium_laurillardi-150k-4096-obj/eremotherium_laurillardi-150k-4096-diffuse.jpg","AssetType":"Texture Map diffuse"}]}}'],
    ['glb',                 '{"success":true,"error":"","modelConstellation":{"Model":{"Name":"eremotherium_laurillardi-150k-4096.glb","Title":"","DateCreated":"2021-04-01T00:00:00.000Z","idVCreationMethod":0,"idVModality":0,"idVUnits":0,"idVPurpose":0,"idVFileType":52,"idAssetThumbnail":null,"CountAnimations":0,"CountCameras":0,"CountFaces":149999,"CountLights":0,"CountMaterials":1,"CountMeshes":1,"CountVertices":104561,"CountEmbeddedTextures":1,"CountLinkedTextures":0,"FileEncoding":"BINARY","IsDracoCompressed":false,"AutomationTag":null,"CountTriangles":149999,"idModel":1},"ModelObjects":[{"idModelObject":1,"idModel":1,"BoundingBoxP1X":-892.2620849609375,"BoundingBoxP1Y":-2167.867431640625,"BoundingBoxP1Z":-971.3921508789062,"BoundingBoxP2X":892.2653198242188,"BoundingBoxP2Y":2167.86767578125,"BoundingBoxP2Z":971.3909301757812,"CountVertices":104561,"CountFaces":149999,"CountColorChannels":0,"CountTextureCoordinateChannels":1,"HasBones":false,"HasFaceNormals":true,"HasTangents":null,"HasTextureCoordinates":true,"HasVertexNormals":null,"HasVertexColor":false,"IsTwoManifoldUnbounded":false,"IsTwoManifoldBounded":true,"IsWatertight":false,"SelfIntersecting":true,"CountTriangles":149999}],"ModelMaterials":[{"idModelMaterial":1,"Name":"material_0"}],"ModelMaterialChannels":[{"idModelMaterialChannel":1,"idModelMaterial":1,"idVMaterialType":64,"MaterialTypeOther":null,"idModelMaterialUVMap":null,"UVMapEmbedded":true,"ChannelPosition":null,"ChannelWidth":null,"Scalar1":1,"Scalar2":1,"Scalar3":1,"Scalar4":1,"AdditionalAttributes":null}],"ModelMaterialUVMaps":null,"ModelObjectModelMaterialXref":[{"idModelObjectModelMaterialXref":1,"idModelObject":1,"idModelMaterial":1}],"ModelAssets":[{"Asset":{"FileName":"eremotherium_laurillardi-150k-4096.glb","idAssetGroup":null,"idVAssetType":0,"idSystemObject":null,"StorageKey":null,"idAsset":1},"AssetVersion":{"idAsset":1,"Version":0,"FileName":"eremotherium_laurillardi-150k-4096.glb","idUserCreator":0,"DateCreated":"2021-04-01T00:00:00.000Z","StorageHash":"","StorageSize":"0","StorageKeyStaging":"","Ingested":null,"BulkIngest":false,"idSOAttachment":null,"FilePath":"","Comment":"Created by Cook si-packrat-inspect","idAssetVersion":1,"IngestedOrig":null},"AssetName":"eremotherium_laurillardi-150k-4096.glb","AssetType":"Model"}]}}'],
    ['glb-draco',           '{"success":true,"error":"","modelConstellation":{"Model":{"Name":"eremotherium_laurillardi-Part-100k-512.glb","Title":"","DateCreated":"2021-04-01T00:00:00.000Z","idVCreationMethod":0,"idVModality":0,"idVUnits":0,"idVPurpose":0,"idVFileType":52,"idAssetThumbnail":null,"CountAnimations":0,"CountCameras":0,"CountFaces":99766,"CountLights":0,"CountMaterials":1,"CountMeshes":1,"CountVertices":64464,"CountEmbeddedTextures":3,"CountLinkedTextures":0,"FileEncoding":"BINARY","IsDracoCompressed":true,"AutomationTag":null,"CountTriangles":99766,"idModel":1},"ModelObjects":[{"idModelObject":1,"idModel":1,"BoundingBoxP1X":-68.70997619628906,"BoundingBoxP1Y":-167.00453186035156,"BoundingBoxP1Z":-61.58316421508789,"BoundingBoxP2X":56.08637237548828,"BoundingBoxP2Y":14.136469841003418,"BoundingBoxP2Z":117.65611267089844,"CountVertices":64464,"CountFaces":99766,"CountColorChannels":0,"CountTextureCoordinateChannels":1,"HasBones":false,"HasFaceNormals":true,"HasTangents":null,"HasTextureCoordinates":true,"HasVertexNormals":null,"HasVertexColor":false,"IsTwoManifoldUnbounded":false,"IsTwoManifoldBounded":true,"IsWatertight":false,"SelfIntersecting":true,"CountTriangles":99766}],"ModelMaterials":[{"idModelMaterial":1,"Name":"default"}],"ModelMaterialChannels":[{"idModelMaterialChannel":1,"idModelMaterial":1,"idVMaterialType":64,"MaterialTypeOther":null,"idModelMaterialUVMap":null,"UVMapEmbedded":true,"ChannelPosition":null,"ChannelWidth":null,"Scalar1":1,"Scalar2":1,"Scalar3":1,"Scalar4":1,"AdditionalAttributes":null},{"idModelMaterialChannel":2,"idModelMaterial":1,"idVMaterialType":69,"MaterialTypeOther":null,"idModelMaterialUVMap":null,"UVMapEmbedded":true,"ChannelPosition":null,"ChannelWidth":null,"Scalar1":null,"Scalar2":null,"Scalar3":null,"Scalar4":null,"AdditionalAttributes":null},{"idModelMaterialChannel":3,"idModelMaterial":1,"idVMaterialType":73,"MaterialTypeOther":null,"idModelMaterialUVMap":null,"UVMapEmbedded":true,"ChannelPosition":null,"ChannelWidth":null,"Scalar1":null,"Scalar2":null,"Scalar3":null,"Scalar4":null,"AdditionalAttributes":null}],"ModelMaterialUVMaps":null,"ModelObjectModelMaterialXref":[{"idModelObjectModelMaterialXref":1,"idModelObject":1,"idModelMaterial":1}],"ModelAssets":[{"Asset":{"FileName":"eremotherium_laurillardi-Part-100k-512.glb","idAssetGroup":null,"idVAssetType":0,"idSystemObject":null,"StorageKey":null,"idAsset":1},"AssetVersion":{"idAsset":1,"Version":0,"FileName":"eremotherium_laurillardi-Part-100k-512.glb","idUserCreator":0,"DateCreated":"2021-04-01T00:00:00.000Z","StorageHash":"","StorageSize":"0","StorageKeyStaging":"","Ingested":null,"BulkIngest":false,"idSOAttachment":null,"FilePath":"","Comment":"Created by Cook si-packrat-inspect","idAssetVersion":1,"IngestedOrig":null},"AssetName":"eremotherium_laurillardi-Part-100k-512.glb","AssetType":"Model"}]}}'],
    ['obj',                 '{"success":true,"error":"","modelConstellation":{"Model":{"Name":"eremotherium_laurillardi-150k-4096.obj","Title":"","DateCreated":"2021-04-01T00:00:00.000Z","idVCreationMethod":0,"idVModality":0,"idVUnits":0,"idVPurpose":0,"idVFileType":49,"idAssetThumbnail":null,"CountAnimations":0,"CountCameras":0,"CountFaces":149999,"CountLights":0,"CountMaterials":1,"CountMeshes":1,"CountVertices":74796,"CountEmbeddedTextures":0,"CountLinkedTextures":1,"FileEncoding":"ASCII","IsDracoCompressed":false,"AutomationTag":null,"CountTriangles":149999,"idModel":1},"ModelObjects":[{"idModelObject":1,"idModel":1,"BoundingBoxP1X":-892.2620849609375,"BoundingBoxP1Y":-971.3923950195312,"BoundingBoxP1Z":-2167.867919921875,"BoundingBoxP2X":892.2653198242188,"BoundingBoxP2Y":971.3911743164062,"BoundingBoxP2Z":2167.86767578125,"CountVertices":74796,"CountFaces":149999,"CountColorChannels":0,"CountTextureCoordinateChannels":1,"HasBones":false,"HasFaceNormals":true,"HasTangents":null,"HasTextureCoordinates":true,"HasVertexNormals":null,"HasVertexColor":false,"IsTwoManifoldUnbounded":false,"IsTwoManifoldBounded":false,"IsWatertight":false,"SelfIntersecting":true,"CountTriangles":149999}],"ModelMaterials":[{"idModelMaterial":1,"Name":"material_0"}],"ModelMaterialChannels":[{"idModelMaterialChannel":1,"idModelMaterial":1,"idVMaterialType":64,"MaterialTypeOther":null,"idModelMaterialUVMap":1,"UVMapEmbedded":false,"ChannelPosition":0,"ChannelWidth":3,"Scalar1":0.6,"Scalar2":0.6,"Scalar3":0.6,"Scalar4":null,"AdditionalAttributes":null,"Source":"eremotherium_laurillardi-150k-4096-diffuse.jpg"}],"ModelMaterialUVMaps":[{"idModel":1,"idAsset":2,"UVMapEdgeLength":0,"idModelMaterialUVMap":1}],"ModelObjectModelMaterialXref":[{"idModelObjectModelMaterialXref":1,"idModelObject":1,"idModelMaterial":1}],"ModelAssets":[{"Asset":{"FileName":"eremotherium_laurillardi-150k-4096.obj","idAssetGroup":null,"idVAssetType":0,"idSystemObject":null,"StorageKey":null,"idAsset":1},"AssetVersion":{"idAsset":1,"Version":0,"FileName":"eremotherium_laurillardi-150k-4096.obj","idUserCreator":0,"DateCreated":"2021-04-01T00:00:00.000Z","StorageHash":"","StorageSize":"0","StorageKeyStaging":"","Ingested":null,"BulkIngest":false,"idSOAttachment":null,"FilePath":"","Comment":"Created by Cook si-packrat-inspect","idAssetVersion":1,"IngestedOrig":null},"AssetName":"eremotherium_laurillardi-150k-4096.obj","AssetType":"Model"},{"Asset":{"FileName":"eremotherium_laurillardi-150k-4096-diffuse.jpg","idAssetGroup":null,"idVAssetType":0,"idSystemObject":null,"StorageKey":null,"idAsset":2},"AssetVersion":{"idAsset":2,"Version":0,"FileName":"eremotherium_laurillardi-150k-4096-diffuse.jpg","idUserCreator":0,"DateCreated":"2021-04-01T00:00:00.000Z","StorageHash":"","StorageSize":"0","StorageKeyStaging":"","Ingested":null,"BulkIngest":false,"idSOAttachment":null,"FilePath":"","Comment":"Created by Cook si-packrat-inspect","idAssetVersion":2,"IngestedOrig":null},"AssetName":"eremotherium_laurillardi-150k-4096-diffuse.jpg","AssetType":"Texture Map diffuse"}]}}'],
    ['ply',                 '{"success":true,"error":"","modelConstellation":{"Model":{"Name":"eremotherium_laurillardi-150k.ply","Title":"","DateCreated":"2021-04-01T00:00:00.000Z","idVCreationMethod":0,"idVModality":0,"idVUnits":0,"idVPurpose":0,"idVFileType":50,"idAssetThumbnail":null,"CountAnimations":0,"CountCameras":0,"CountFaces":149999,"CountLights":0,"CountMaterials":1,"CountMeshes":1,"CountVertices":74796,"CountEmbeddedTextures":0,"CountLinkedTextures":1,"FileEncoding":"BINARY","IsDracoCompressed":false,"AutomationTag":null,"CountTriangles":149999,"idModel":1},"ModelObjects":[{"idModelObject":1,"idModel":1,"BoundingBoxP1X":-892.2620849609375,"BoundingBoxP1Y":-971.3921508789062,"BoundingBoxP1Z":-2167.86767578125,"BoundingBoxP2X":892.2653198242188,"BoundingBoxP2Y":971.3909301757812,"BoundingBoxP2Z":2167.867431640625,"CountVertices":74796,"CountFaces":149999,"CountColorChannels":1,"CountTextureCoordinateChannels":0,"HasBones":false,"HasFaceNormals":false,"HasTangents":null,"HasTextureCoordinates":false,"HasVertexNormals":null,"HasVertexColor":true,"IsTwoManifoldUnbounded":false,"IsTwoManifoldBounded":false,"IsWatertight":false,"SelfIntersecting":true,"CountTriangles":149999}],"ModelMaterials":[{"idModelMaterial":1,"Name":""}],"ModelMaterialChannels":[{"idModelMaterialChannel":1,"idModelMaterial":1,"idVMaterialType":64,"MaterialTypeOther":null,"idModelMaterialUVMap":1,"UVMapEmbedded":false,"ChannelPosition":0,"ChannelWidth":3,"Scalar1":1,"Scalar2":1,"Scalar3":1,"Scalar4":1,"AdditionalAttributes":null,"Source":"eremotherium_laurillardi-150k-4096-diffuse.jpg"}],"ModelMaterialUVMaps":[{"idModel":1,"idAsset":2,"UVMapEdgeLength":0,"idModelMaterialUVMap":1}],"ModelObjectModelMaterialXref":[{"idModelObjectModelMaterialXref":1,"idModelObject":1,"idModelMaterial":1}],"ModelAssets":[{"Asset":{"FileName":"eremotherium_laurillardi-150k.ply","idAssetGroup":null,"idVAssetType":0,"idSystemObject":null,"StorageKey":null,"idAsset":1},"AssetVersion":{"idAsset":1,"Version":0,"FileName":"eremotherium_laurillardi-150k.ply","idUserCreator":0,"DateCreated":"2021-04-01T00:00:00.000Z","StorageHash":"","StorageSize":"0","StorageKeyStaging":"","Ingested":null,"BulkIngest":false,"idSOAttachment":null,"FilePath":"","Comment":"Created by Cook si-packrat-inspect","idAssetVersion":1,"IngestedOrig":null},"AssetName":"eremotherium_laurillardi-150k.ply","AssetType":"Model"},{"Asset":{"FileName":"eremotherium_laurillardi-150k-4096-diffuse.jpg","idAssetGroup":null,"idVAssetType":0,"idSystemObject":null,"StorageKey":null,"idAsset":2},"AssetVersion":{"idAsset":2,"Version":0,"FileName":"eremotherium_laurillardi-150k-4096-diffuse.jpg","idUserCreator":0,"DateCreated":"2021-04-01T00:00:00.000Z","StorageHash":"","StorageSize":"0","StorageKeyStaging":"","Ingested":null,"BulkIngest":false,"idSOAttachment":null,"FilePath":"","Comment":"Created by Cook si-packrat-inspect","idAssetVersion":2,"IngestedOrig":null},"AssetName":"eremotherium_laurillardi-150k-4096-diffuse.jpg","AssetType":"Texture Map diffuse"}]}}'],
    ['stl',                 '{"success":true,"error":"","modelConstellation":{"Model":{"Name":"eremotherium_laurillardi-150k.stl","Title":"","DateCreated":"2021-04-01T00:00:00.000Z","idVCreationMethod":0,"idVModality":0,"idVUnits":0,"idVPurpose":0,"idVFileType":51,"idAssetThumbnail":null,"CountAnimations":0,"CountCameras":0,"CountFaces":149999,"CountLights":0,"CountMaterials":0,"CountMeshes":1,"CountVertices":74796,"CountEmbeddedTextures":0,"CountLinkedTextures":0,"FileEncoding":"BINARY","IsDracoCompressed":false,"AutomationTag":null,"CountTriangles":149999,"idModel":1},"ModelObjects":[{"idModelObject":1,"idModel":1,"BoundingBoxP1X":-892.2620849609375,"BoundingBoxP1Y":-971.3921508789062,"BoundingBoxP1Z":-2167.86767578125,"BoundingBoxP2X":892.2653198242188,"BoundingBoxP2Y":971.3909301757812,"BoundingBoxP2Z":2167.867431640625,"CountVertices":74796,"CountFaces":149999,"CountColorChannels":0,"CountTextureCoordinateChannels":0,"HasBones":false,"HasFaceNormals":false,"HasTangents":null,"HasTextureCoordinates":false,"HasVertexNormals":null,"HasVertexColor":false,"IsTwoManifoldUnbounded":false,"IsTwoManifoldBounded":false,"IsWatertight":false,"SelfIntersecting":true,"CountTriangles":149999}],"ModelMaterials":null,"ModelMaterialChannels":null,"ModelMaterialUVMaps":null,"ModelObjectModelMaterialXref":null,"ModelAssets":[{"Asset":{"FileName":"eremotherium_laurillardi-150k.stl","idAssetGroup":null,"idVAssetType":0,"idSystemObject":null,"StorageKey":null,"idAsset":1},"AssetVersion":{"idAsset":1,"Version":0,"FileName":"eremotherium_laurillardi-150k.stl","idUserCreator":0,"DateCreated":"2021-04-01T00:00:00.000Z","StorageHash":"","StorageSize":"0","StorageKeyStaging":"","Ingested":null,"BulkIngest":false,"idSOAttachment":null,"FilePath":"","Comment":"Created by Cook si-packrat-inspect","idAssetVersion":1,"IngestedOrig":null},"AssetName":"eremotherium_laurillardi-150k.stl","AssetType":"Model"}]}}'],
    ['x3d',                 '{"success":true,"error":"","modelConstellation":{"Model":{"Name":"eremotherium_laurillardi-150k-4096.x3d","Title":"","DateCreated":"2021-04-01T00:00:00.000Z","idVCreationMethod":0,"idVModality":0,"idVUnits":0,"idVPurpose":0,"idVFileType":56,"idAssetThumbnail":null,"CountAnimations":0,"CountCameras":0,"CountFaces":149999,"CountLights":0,"CountMaterials":1,"CountMeshes":1,"CountVertices":74796,"CountEmbeddedTextures":0,"CountLinkedTextures":1,"FileEncoding":"ASCII","IsDracoCompressed":false,"AutomationTag":null,"CountTriangles":149999,"idModel":1},"ModelObjects":[{"idModelObject":1,"idModel":1,"BoundingBoxP1X":-892.2651977539062,"BoundingBoxP1Y":-2167.870361328125,"BoundingBoxP1Z":-971.3923950195312,"BoundingBoxP2X":892.26220703125,"BoundingBoxP2Y":2167.870361328125,"BoundingBoxP2Z":971.391357421875,"CountVertices":74796,"CountFaces":149999,"CountColorChannels":1,"CountTextureCoordinateChannels":1,"HasBones":false,"HasFaceNormals":false,"HasTangents":null,"HasTextureCoordinates":true,"HasVertexNormals":null,"HasVertexColor":true,"IsTwoManifoldUnbounded":false,"IsTwoManifoldBounded":false,"IsWatertight":false,"SelfIntersecting":true,"CountTriangles":149999}],"ModelMaterials":[{"idModelMaterial":1,"Name":""}],"ModelMaterialChannels":[{"idModelMaterialChannel":1,"idModelMaterial":1,"idVMaterialType":64,"MaterialTypeOther":null,"idModelMaterialUVMap":1,"UVMapEmbedded":false,"ChannelPosition":0,"ChannelWidth":3,"Scalar1":null,"Scalar2":null,"Scalar3":null,"Scalar4":null,"AdditionalAttributes":null,"Source":"eremotherium_laurillardi-150k-4096-diffuse.jpg"}],"ModelMaterialUVMaps":[{"idModel":1,"idAsset":2,"UVMapEdgeLength":0,"idModelMaterialUVMap":1}],"ModelObjectModelMaterialXref":null,"ModelAssets":[{"Asset":{"FileName":"eremotherium_laurillardi-150k-4096.x3d","idAssetGroup":null,"idVAssetType":0,"idSystemObject":null,"StorageKey":null,"idAsset":1},"AssetVersion":{"idAsset":1,"Version":0,"FileName":"eremotherium_laurillardi-150k-4096.x3d","idUserCreator":0,"DateCreated":"2021-04-01T00:00:00.000Z","StorageHash":"","StorageSize":"0","StorageKeyStaging":"","Ingested":null,"BulkIngest":false,"idSOAttachment":null,"FilePath":"","Comment":"Created by Cook si-packrat-inspect","idAssetVersion":1,"IngestedOrig":null},"AssetName":"eremotherium_laurillardi-150k-4096.x3d","AssetType":"Model"},{"Asset":{"FileName":"eremotherium_laurillardi-150k-4096-diffuse.jpg","idAssetGroup":null,"idVAssetType":0,"idSystemObject":null,"StorageKey":null,"idAsset":2},"AssetVersion":{"idAsset":2,"Version":0,"FileName":"eremotherium_laurillardi-150k-4096-diffuse.jpg","idUserCreator":0,"DateCreated":"2021-04-01T00:00:00.000Z","StorageHash":"","StorageSize":"0","StorageKeyStaging":"","Ingested":null,"BulkIngest":false,"idSOAttachment":null,"FilePath":"","Comment":"Created by Cook si-packrat-inspect","idAssetVersion":2,"IngestedOrig":null},"AssetName":"eremotherium_laurillardi-150k-4096-diffuse.jpg","AssetType":"Texture Map diffuse"}]}}'],
    ['dae',                 '{"success":true,"error":"","modelConstellation":{"Model":{"Name":"clemente_helmet.dae","Title":"","DateCreated":"2021-04-01T00:00:00.000Z","idVCreationMethod":0,"idVModality":0,"idVUnits":0,"idVPurpose":0,"idVFileType":58,"idAssetThumbnail":null,"CountAnimations":0,"CountCameras":0,"CountFaces":148260,"CountLights":0,"CountMaterials":1,"CountMeshes":1,"CountVertices":80417,"CountEmbeddedTextures":0,"CountLinkedTextures":1,"FileEncoding":"ASCII","IsDracoCompressed":false,"AutomationTag":null,"CountTriangles":148260,"idModel":1},"ModelObjects":[{"idModelObject":1,"idModel":1,"BoundingBoxP1X":-0.09380000084638596,"BoundingBoxP1Y":-0.13996900618076324,"BoundingBoxP1Z":-0.06898897141218185,"BoundingBoxP2X":0.09380996227264404,"BoundingBoxP2Y":0.139957994222641,"BoundingBoxP2Z":0.0689619705080986,"CountVertices":80417,"CountFaces":148260,"CountColorChannels":0,"CountTextureCoordinateChannels":1,"HasBones":false,"HasFaceNormals":false,"HasTangents":null,"HasTextureCoordinates":true,"HasVertexNormals":null,"HasVertexColor":false,"IsTwoManifoldUnbounded":false,"IsTwoManifoldBounded":true,"IsWatertight":false,"SelfIntersecting":true,"CountTriangles":148260}],"ModelMaterials":[{"idModelMaterial":1,"Name":"default"}],"ModelMaterialChannels":[{"idModelMaterialChannel":1,"idModelMaterial":1,"idVMaterialType":64,"MaterialTypeOther":null,"idModelMaterialUVMap":1,"UVMapEmbedded":false,"ChannelPosition":0,"ChannelWidth":3,"Scalar1":1,"Scalar2":1,"Scalar3":1,"Scalar4":null,"AdditionalAttributes":null,"Source":"Image_0.jpg"}],"ModelMaterialUVMaps":[{"idModel":1,"idAsset":2,"UVMapEdgeLength":0,"idModelMaterialUVMap":1}],"ModelObjectModelMaterialXref":[{"idModelObjectModelMaterialXref":1,"idModelObject":1,"idModelMaterial":1}],"ModelAssets":[{"Asset":{"FileName":"clemente_helmet.dae","idAssetGroup":null,"idVAssetType":0,"idSystemObject":null,"StorageKey":null,"idAsset":1},"AssetVersion":{"idAsset":1,"Version":0,"FileName":"clemente_helmet.dae","idUserCreator":0,"DateCreated":"2021-04-01T00:00:00.000Z","StorageHash":"","StorageSize":"0","StorageKeyStaging":"","Ingested":null,"BulkIngest":false,"idSOAttachment":null,"FilePath":"","Comment":"Created by Cook si-packrat-inspect","idAssetVersion":1,"IngestedOrig":null},"AssetName":"clemente_helmet.dae","AssetType":"Model"},{"Asset":{"FileName":"Image_0.jpg","idAssetGroup":null,"idVAssetType":0,"idSystemObject":null,"StorageKey":null,"idAsset":2},"AssetVersion":{"idAsset":2,"Version":0,"FileName":"Image_0.jpg","idUserCreator":0,"DateCreated":"2021-04-01T00:00:00.000Z","StorageHash":"","StorageSize":"0","StorageKeyStaging":"","Ingested":null,"BulkIngest":false,"idSOAttachment":null,"FilePath":"","Comment":"Created by Cook si-packrat-inspect","idAssetVersion":2,"IngestedOrig":null},"AssetName":"Image_0.jpg","AssetType":"Texture Map diffuse"}]}}'],
    ['gltf-stand-alone',    '{"success":true,"error":"","modelConstellation":{"Model":{"Name":"clemente_helmet.gltf","Title":"","DateCreated":"2021-04-01T00:00:00.000Z","idVCreationMethod":0,"idVModality":0,"idVUnits":0,"idVPurpose":0,"idVFileType":53,"idAssetThumbnail":null,"CountAnimations":0,"CountCameras":0,"CountFaces":148260,"CountLights":0,"CountMaterials":1,"CountMeshes":1,"CountVertices":80417,"CountEmbeddedTextures":3,"CountLinkedTextures":0,"FileEncoding":"ASCII","IsDracoCompressed":false,"AutomationTag":null,"CountTriangles":148260,"idModel":1},"ModelObjects":[{"idModelObject":1,"idModel":1,"BoundingBoxP1X":-0.09380000084638596,"BoundingBoxP1Y":-0.13996900618076324,"BoundingBoxP1Z":-0.06898900121450424,"BoundingBoxP2X":0.09380999952554703,"BoundingBoxP2Y":0.139957994222641,"BoundingBoxP2Z":0.06896200031042099,"CountVertices":80417,"CountFaces":148260,"CountColorChannels":0,"CountTextureCoordinateChannels":1,"HasBones":false,"HasFaceNormals":true,"HasTangents":null,"HasTextureCoordinates":true,"HasVertexNormals":null,"HasVertexColor":false,"IsTwoManifoldUnbounded":false,"IsTwoManifoldBounded":true,"IsWatertight":false,"SelfIntersecting":true,"CountTriangles":148260}],"ModelMaterials":[{"idModelMaterial":1,"Name":"default"}],"ModelMaterialChannels":[{"idModelMaterialChannel":1,"idModelMaterial":1,"idVMaterialType":64,"MaterialTypeOther":null,"idModelMaterialUVMap":null,"UVMapEmbedded":true,"ChannelPosition":null,"ChannelWidth":null,"Scalar1":1,"Scalar2":1,"Scalar3":1,"Scalar4":1,"AdditionalAttributes":null},{"idModelMaterialChannel":2,"idModelMaterial":1,"idVMaterialType":69,"MaterialTypeOther":null,"idModelMaterialUVMap":null,"UVMapEmbedded":true,"ChannelPosition":null,"ChannelWidth":null,"Scalar1":null,"Scalar2":null,"Scalar3":null,"Scalar4":null,"AdditionalAttributes":null},{"idModelMaterialChannel":3,"idModelMaterial":1,"idVMaterialType":73,"MaterialTypeOther":null,"idModelMaterialUVMap":null,"UVMapEmbedded":true,"ChannelPosition":null,"ChannelWidth":null,"Scalar1":null,"Scalar2":null,"Scalar3":null,"Scalar4":null,"AdditionalAttributes":null}],"ModelMaterialUVMaps":null,"ModelObjectModelMaterialXref":[{"idModelObjectModelMaterialXref":1,"idModelObject":1,"idModelMaterial":1}],"ModelAssets":[{"Asset":{"FileName":"clemente_helmet.gltf","idAssetGroup":null,"idVAssetType":0,"idSystemObject":null,"StorageKey":null,"idAsset":1},"AssetVersion":{"idAsset":1,"Version":0,"FileName":"clemente_helmet.gltf","idUserCreator":0,"DateCreated":"2021-04-01T00:00:00.000Z","StorageHash":"","StorageSize":"0","StorageKeyStaging":"","Ingested":null,"BulkIngest":false,"idSOAttachment":null,"FilePath":"","Comment":"Created by Cook si-packrat-inspect","idAssetVersion":1,"IngestedOrig":null},"AssetName":"clemente_helmet.gltf","AssetType":"Model"}]}}'],
    ['gltf-with-support',   '{"success":true,"error":"","modelConstellation":{"Model":{"Name":"nmah-1981_0706_06-clemente_helmet-150k-4096.gltf","Title":"","DateCreated":"2021-04-01T00:00:00.000Z","idVCreationMethod":0,"idVModality":0,"idVUnits":0,"idVPurpose":0,"idVFileType":53,"idAssetThumbnail":null,"CountAnimations":0,"CountCameras":0,"CountFaces":148260,"CountLights":0,"CountMaterials":1,"CountMeshes":1,"CountVertices":80417,"CountEmbeddedTextures":0,"CountLinkedTextures":3,"FileEncoding":"ASCII","IsDracoCompressed":false,"AutomationTag":null,"CountTriangles":148260,"idModel":1},"ModelObjects":[{"idModelObject":1,"idModel":1,"BoundingBoxP1X":-0.09380000084638596,"BoundingBoxP1Y":-0.13996900618076324,"BoundingBoxP1Z":-0.06898900121450424,"BoundingBoxP2X":0.09380999952554703,"BoundingBoxP2Y":0.139957994222641,"BoundingBoxP2Z":0.06896200031042099,"CountVertices":80417,"CountFaces":148260,"CountColorChannels":0,"CountTextureCoordinateChannels":1,"HasBones":false,"HasFaceNormals":true,"HasTangents":null,"HasTextureCoordinates":true,"HasVertexNormals":null,"HasVertexColor":false,"IsTwoManifoldUnbounded":false,"IsTwoManifoldBounded":true,"IsWatertight":false,"SelfIntersecting":true,"CountTriangles":148260}],"ModelMaterials":[{"idModelMaterial":1,"Name":"default"}],"ModelMaterialChannels":[{"idModelMaterialChannel":1,"idModelMaterial":1,"idVMaterialType":64,"MaterialTypeOther":null,"idModelMaterialUVMap":1,"UVMapEmbedded":false,"ChannelPosition":0,"ChannelWidth":3,"Scalar1":1,"Scalar2":1,"Scalar3":1,"Scalar4":1,"AdditionalAttributes":null,"Source":"nmah-1981_0706_06-clemente_helmet-150k-4096-diffuse.jpg"},{"idModelMaterialChannel":2,"idModelMaterial":1,"idVMaterialType":69,"MaterialTypeOther":null,"idModelMaterialUVMap":2,"UVMapEmbedded":false,"ChannelPosition":0,"ChannelWidth":3,"Scalar1":null,"Scalar2":null,"Scalar3":null,"Scalar4":null,"AdditionalAttributes":null,"Source":"nmah-1981_0706_06-clemente_helmet-150k-4096-normals.jpg"},{"idModelMaterialChannel":3,"idModelMaterial":1,"idVMaterialType":73,"MaterialTypeOther":null,"idModelMaterialUVMap":3,"UVMapEmbedded":false,"ChannelPosition":0,"ChannelWidth":3,"Scalar1":null,"Scalar2":null,"Scalar3":null,"Scalar4":null,"AdditionalAttributes":null,"Source":"nmah-1981_0706_06-clemente_helmet-150k-4096-occlusion.jpg"}],"ModelMaterialUVMaps":[{"idModel":1,"idAsset":2,"UVMapEdgeLength":0,"idModelMaterialUVMap":1},{"idModel":1,"idAsset":3,"UVMapEdgeLength":0,"idModelMaterialUVMap":2},{"idModel":1,"idAsset":4,"UVMapEdgeLength":0,"idModelMaterialUVMap":3}],"ModelObjectModelMaterialXref":[{"idModelObjectModelMaterialXref":1,"idModelObject":1,"idModelMaterial":1}],"ModelAssets":[{"Asset":{"FileName":"nmah-1981_0706_06-clemente_helmet-150k-4096.gltf","idAssetGroup":null,"idVAssetType":0,"idSystemObject":null,"StorageKey":null,"idAsset":1},"AssetVersion":{"idAsset":1,"Version":0,"FileName":"nmah-1981_0706_06-clemente_helmet-150k-4096.gltf","idUserCreator":0,"DateCreated":"2021-04-01T00:00:00.000Z","StorageHash":"","StorageSize":"0","StorageKeyStaging":"","Ingested":null,"BulkIngest":false,"idSOAttachment":null,"FilePath":"","Comment":"Created by Cook si-packrat-inspect","idAssetVersion":1,"IngestedOrig":null},"AssetName":"nmah-1981_0706_06-clemente_helmet-150k-4096.gltf","AssetType":"Model"},{"Asset":{"FileName":"nmah-1981_0706_06-clemente_helmet-150k-4096-diffuse.jpg","idAssetGroup":null,"idVAssetType":0,"idSystemObject":null,"StorageKey":null,"idAsset":2},"AssetVersion":{"idAsset":2,"Version":0,"FileName":"nmah-1981_0706_06-clemente_helmet-150k-4096-diffuse.jpg","idUserCreator":0,"DateCreated":"2021-04-01T00:00:00.000Z","StorageHash":"","StorageSize":"0","StorageKeyStaging":"","Ingested":null,"BulkIngest":false,"idSOAttachment":null,"FilePath":"","Comment":"Created by Cook si-packrat-inspect","idAssetVersion":2,"IngestedOrig":null},"AssetName":"nmah-1981_0706_06-clemente_helmet-150k-4096-diffuse.jpg","AssetType":"Texture Map diffuse"},{"Asset":{"FileName":"nmah-1981_0706_06-clemente_helmet-150k-4096-normals.jpg","idAssetGroup":null,"idVAssetType":0,"idSystemObject":null,"StorageKey":null,"idAsset":3},"AssetVersion":{"idAsset":3,"Version":0,"FileName":"nmah-1981_0706_06-clemente_helmet-150k-4096-normals.jpg","idUserCreator":0,"DateCreated":"2021-04-01T00:00:00.000Z","StorageHash":"","StorageSize":"0","StorageKeyStaging":"","Ingested":null,"BulkIngest":false,"idSOAttachment":null,"FilePath":"","Comment":"Created by Cook si-packrat-inspect","idAssetVersion":3,"IngestedOrig":null},"AssetName":"nmah-1981_0706_06-clemente_helmet-150k-4096-normals.jpg","AssetType":"Texture Map normal"},{"Asset":{"FileName":"nmah-1981_0706_06-clemente_helmet-150k-4096-occlusion.jpg","idAssetGroup":null,"idVAssetType":0,"idSystemObject":null,"StorageKey":null,"idAsset":4},"AssetVersion":{"idAsset":4,"Version":0,"FileName":"nmah-1981_0706_06-clemente_helmet-150k-4096-occlusion.jpg","idUserCreator":0,"DateCreated":"2021-04-01T00:00:00.000Z","StorageHash":"","StorageSize":"0","StorageKeyStaging":"","Ingested":null,"BulkIngest":false,"idSOAttachment":null,"FilePath":"","Comment":"Created by Cook si-packrat-inspect","idAssetVersion":4,"IngestedOrig":null},"AssetName":"nmah-1981_0706_06-clemente_helmet-150k-4096-occlusion.jpg","AssetType":"Texture Map occlusion"}]}}'],
]);

export class ModelTestSetup {
    /* #region Variable Declarations */
    userOwner:                  DBAPI.User | null = null;

    testCaseMap:                Map<string, ModelTestCase> = new Map<string, ModelTestCase>(); // map of testcase name to ModelTestCase structure
    masterCreated:              boolean = false;
    /* #endregion */

    //** Returns null if initialize cannot locate test files.  Do not treat this as an error */
    async initialize(testCase?: undefined): Promise<boolean | null>;
    async initialize(testCase: string): Promise<boolean | null>;
    async initialize(testCase: string[]): Promise<boolean | null>;
    async initialize(testCase: string | string[] | undefined): Promise<boolean | null> {
        // let assigned: boolean = true;
        this.userOwner = await UTIL.createUserTest({ Name: 'Model Test', EmailAddress: 'modeltest@si.edu', SecurityID: 'Model Test', Active: true, DateActivated: UTIL.nowCleansed(), DateDisabled: null, WorkflowNotificationTime: UTIL.nowCleansed(), EmailSettings: 0, idUser: 0 });
        if (!this.userOwner) {
            LOG.error('ModelTestSetup failed to create user', LOG.LS.eTEST);
            return false;
        }

        // normalize parameters used to select test case
        const testCaseSet: Set<string> | null = testCase ? new Set<string>() : null;
        if (testCase) {
            if (typeof(testCase) === 'string')
                testCaseSet!.add(testCase); // eslint-disable-line @typescript-eslint/no-non-null-assertion
            else if (Array.isArray(testCase)) {
                for (const testCaseEntry of testCase) {
                    if (typeof(testCaseEntry) === 'string')
                        testCaseSet!.add(testCaseEntry); // eslint-disable-line @typescript-eslint/no-non-null-assertion
                }
            }
        }

        const migrationFilesMap: Map<string, MIG.ModelMigrationFile[]> = new Map<string, MIG.ModelMigrationFile[]>(); // map of ModelMigrationFile.uniqueID -> ModelMigrationFile[]
        for (const MMF of MIG.ModelMigrationTestFiles) {
            if (testCaseSet && !testCaseSet.has(MMF.uniqueID))  // trim ModelMigrationFiles to only those of interest
                continue;

            let MMFList: MIG.ModelMigrationFile[] | undefined = migrationFilesMap.get(MMF.uniqueID);
            if (!MMFList) {
                MMFList = [];
                migrationFilesMap.set(MMF.uniqueID, MMFList);
            }
            MMFList.push(MMF);
        }

        for (const [ uniqueID, MMFList ] of migrationFilesMap) {
            LOG.info(`ModelTestSetup handling ${uniqueID} with ${MMFList.length} files`, LOG.LS.eTEST);
            const MM: MIG.ModelMigration = new MIG.ModelMigration();
            const resMigration: MIG.ModelMigrationResults = await MM.migrateModel(MMFList, this.userOwner.idUser, true, true);
            if (!resMigration.success || !resMigration.model || !resMigration.modelFileName) {
                if (resMigration.filesMissing)    // handle special case where files are not present
                    return null;        // return null to mean "not performing this test"
                LOG.error(`ModelTestSetup handling ${uniqueID} failed: ${H.Helpers.JSONStringify(resMigration)}`, LOG.LS.eTEST);
                continue;
            }

            // record test case data
            if (resMigration.assetVersion) {
                let MTC: ModelTestCase | undefined = this.testCaseMap.get(uniqueID);
                if (!MTC) {
                    const inspectJSON: string | undefined = modelTestCaseInspectJSONMap.get(uniqueID) || '';
                    MTC = new ModelTestCase(uniqueID, resMigration.model, resMigration.modelFileName, resMigration.assetVersion, inspectJSON);
                    this.testCaseMap.set(uniqueID, MTC);
                }
            }
        }

        return true;
    }

    getTestCase(testCase: string): ModelTestCase | undefined {
        return this.testCaseMap.get(testCase);
    }
}